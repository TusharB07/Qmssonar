<div class="grid">
    <div class="col-12">
        <div class="card">
            <p-toast></p-toast>
            <p-toolbar styleClass="mb-4">
                <ng-template pTemplate="left">
                    <div class="my-2">
                        <button id="TaskList_CreateRecord" pButton pRipple label="New" icon="pi pi-plus"
                            class="p-button-success mr-2" (click)="this.createRecord()"></button>
                        <!-- <button id="TaskList_DeleteSelectedRecordsConfirmation" pButton pRipple label="Delete" icon="pi pi-trash" class="p-button-danger mr-2" (click)="this.openDeleteSelectedRecordsConfirmationDialog()" [disabled]="!this.selectedRecords || !this.selectedRecords.length"></button> -->
                        <button id="TaskList_Clear" pButton label="Clear" class="p-button-outlined"
                            icon="pi pi-filter-slash" (click)="clear(dt)"></button>
                    </div>
                </ng-template>

                <ng-template pTemplate="right">
                    <div class="flex flex-column md:flex-row md:justify-content-between md:align-items-center mr-2">
                        <span class="block mt-2 md:mt-0 p-input-icon-left">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text" id="TaskList_FilterGlobal"
                                (input)="dt.filterGlobal($event.target.value, 'contains')"
                                placeholder="Search by LovKey" />
                        </span>
                    </div>

                    <!-- <p-fileUpload mode="basic" id="TaskList_FileUpload" accept="image/*" [maxFileSize]="1000000" label="" chooseLabel="" class="mr-2 inline-block"></p-fileUpload> -->
                    <!-- <button pButton pRipple label="" icon="pi pi-upload" class="p-button-help" (click)="dt.exportCSV()"></button> -->
                </ng-template>
            </p-toolbar>

            <p-table [rowHover]="true" #dt [value]="this.records" [lazy]="true" (onLazyLoad)="this.loadRecords($event)"
                responsiveLayout="scroll" dataKey="_id" [selection]="this.selectedRecords"
                (selectionChange)="this.onSelectionChange($event)" [selectAll]="selectAll"
                (selectAllChange)="this.onSelectAllChange($event)" [paginator]="true" [rowsPerPageOptions]="[10,20,30]"
                [rows]="20" [totalRecords]="totalRecords" [loading]="loading" [globalFilterFields]="['lovKey']">

                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: 3rem">
                            <p-tableHeaderCheckbox id="TaskList_HeaderCheckBox"></p-tableHeaderCheckbox>
                        </th>
                        <th pSortableColumn="parentDocumentId">
                            <div class="flex justify-content-between align-items-center">
                                <span style="white-space: nowrap">Parent Document </span>
                                <p-columnFilter field="parentDocumentId" matchMode="equals" display="menu"
                                    [showClearButton]="false" [hideOnClear]="true" [showApplyButton]="false"
                                    [showMatchModes]="false" [showOperator]="false" [showAddButton]="false">
                                    <ng-template pTemplate="header">
                                        <div class="px-3 pt-3 pb-0">
                                            <span class="font-bold">Parent Document filter</span>
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="filter" let-group let-filter="filterCallback">
                                        <p-autoComplete [(ngModel)]="selectedParentLovId"
                                            [suggestions]="optionsParentLovId"
                                            (completeMethod)="getOptionsParentLovId($event)" field="parentDocumentId"
                                            [dropdown]="true" [multiple]="true"
                                            (onSelect)="ParentLovIdHandleFilter($event)"
                                            (onUnselect)="ParentLovIdHandleFilter($event)">
                                            <ng-template let-group pTemplate="item">
                                                <div class="country-item">
                                                    <div>{{group.label}}</div>
                                                </div>
                                            </ng-template>
                                            <ng-template let-group pTemplate="selectedItem">
                                                <span style="font-size:18px">{{group.label}}</span>
                                            </ng-template>
                                        </p-autoComplete>
                                    </ng-template>
                                </p-columnFilter>
                            </div>
                        </th>
                        <th pSortableColumn="retryCount">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_retryCountHeader">
                                    Retry Count
                                </span>
                                <div>
                                    <p-columnFilter id="TaskList_retryCountColumnFilter" type="text" field="retryCount"
                                        display="retryCount" placeholder="Search by Retry Count"></p-columnFilter>
                                    <p-sortIcon id="TaskList_retryCountSortIcon" field="retryCount"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="retryInterval">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_retryIntervalHeader">
                                    retry Interval
                                </span>
                                <div>
                                    <p-columnFilter id="TaskList_retryIntervalColumnFilter" type="text"
                                        field="retryInterval" display="menu"
                                        placeholder="Search by Retry Interval"></p-columnFilter>
                                    <p-sortIcon id="TaskList_retryIntervalSortIcon" field="retryInterval"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="state">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_stateHeader">
                                    State
                                </span>
                                <div>
                                    <p-columnFilter id="TaskList_stateColumnFilter" type="text" field="state"
                                        display="menu" placeholder="Search by state"></p-columnFilter>
                                    <p-sortIcon id="TaskList_stateSortIcon" field="state"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="price">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_priceHeader">
                                    Price
                                </span>
                                <div>
                                    <p-columnFilter id="TaskList_priceColumnFilter" type="text" field="price"
                                        display="menu" placeholder="Search by price"></p-columnFilter>
                                    <p-sortIcon id="TaskList_priceSortIcon" field="price"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="taskQueueId">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_taskQueueIdHeader">
                                    Task Queue Id
                                </span>
                                <div>
                                    <p-columnFilter id="TaskList_taskQueueIdColumnFilter" type="text"
                                        field="taskQueueId" display="menu"
                                        placeholder="Search by Task Queue Id"></p-columnFilter>
                                    <p-sortIcon id="TaskList_taskQueueIdSortIcon" field="taskQueueId"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="startTime">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_startTimeHeader">
                                    Start Time
                                </span>
                                <div>
                                    <!-- <p-columnFilter id="TaskList_priceColumnFilter" type="text" field="startTime" display="menu" placeholder="Search by Start Time"></p-columnFilter> -->
                                    <p-sortIcon id="TaskList_priceSortIcon" field="startTime"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="createdAt">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_createdAtHeader">
                                    Created At
                                </span>
                                <div>
                                    <!-- <p-columnFilter id="TaskList_createdAtColumnFilter" type="text" field="createdAt" display="menu" placeholder="Search by created At"></p-columnFilter> -->
                                    <p-sortIcon id="TaskList_createdAtSortIcon" field="createdAt"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="endTime">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_endTimeHeader">
                                    End Time
                                </span>
                                <div>
                                    <!-- <p-columnFilter id="TaskList_endTimeColumnFilter" type="text" field="endTime" display="menu" placeholder="Search by End Time"></p-columnFilter> -->
                                    <p-sortIcon id="TaskList_endTimeSortIcon" field="endTime"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="elapsedMillis">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_elapsedMillisHeader">
                                    Elapsed Millis
                                </span>
                                <div>
                                    <p-columnFilter id="TaskList_elapsedMillisColumnFilter" type="text"
                                        field="elapsedMillis" display="menu"
                                        placeholder="Search by Elapsed Millis"></p-columnFilter>
                                    <p-sortIcon id="TaskList_elapsedMillisSortIcon" field="elapsedMillis"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="inputBody">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_inputBodyHeader">
                                    Input Body
                                </span>
                                <div>
                                    <p-columnFilter id="TaskList_inputBodyColumnFilter" type="text" field="inputBody"
                                        display="menu" placeholder="Search by Input Body"></p-columnFilter>
                                    <p-sortIcon id="TaskList_inputBodySortIcon" field="inputBody"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="outputBody">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_outputBodyHeader">
                                    outputBody
                                </span>
                                <div>
                                    <p-columnFilter id="TaskList_outputBodyColumnFilter" type="text" field="outputBody"
                                        display="menu" placeholder="Search by Output Body"></p-columnFilter>
                                    <p-sortIcon id="TaskList_outputBodySortIcon" field="outputBody"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="errorBody">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_errorBodyHeader">
                                    Error Body
                                </span>
                                <div>
                                    <p-columnFilter id="TaskList_errorBodyColumnFilter" type="text" field="errorBody"
                                        display="menu" placeholder="Search by Error Body"></p-columnFilter>
                                    <p-sortIcon id="TaskList_errorBodySortIcon" field="errorBody"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th pSortableColumn="parentDocumentModel">
                            <div class="flex justify-content-between align-items-center">
                                <span id="TaskList_parentDocumentModelHeader">
                                    Parent Document Model
                                </span>
                                <div>
                                    <p-columnFilter id="TaskList_parentDocumentModelColumnFilter" type="text"
                                        field="parentDocumentModel" display="menu"
                                        placeholder="Search by Error Body"></p-columnFilter>
                                    <p-sortIcon id="TaskList_parentDocumentModelSortIcon"
                                        field="parentDocumentModel"></p-sortIcon>
                                </div>
                            </div>
                        </th>
                        <th></th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-item>
                    <tr>
                        <td>
                            <p-tableCheckbox [value]="item" id="TaskList_ItemCheckBox"></p-tableCheckbox>
                        </td>
                        <td id="TaskList_parentDocumentId">
                            {{item.parentDocumentId}}
                        </td>
                        <td id="TaskList_retryCount">
                            {{item.retryCount}}
                        </td>
                        <td id="TaskList_retryInterval">
                            {{item.retryInterval}}
                        </td>
                        <td id="TaskList_state">
                            {{item.state}}
                        </td>
                        <td id="TaskList_price">
                            {{item.price}}
                        </td>
                        <td id="TaskList_taskQueueId">
                            {{item.taskQueueId}}
                        </td>
                        <td id="TaskList_startTime">
                            {{item.startTime}}
                        </td>
                        <td id="TaskList_createdAt">
                            {{item.createdAt}}
                        </td>
                        <td id="TaskList_endTime">
                            {{item.endTime}}
                        </td>
                        <td id="TaskList_elapsedMillis">
                            {{item.elapsedMillis}}
                        </td>
                        <td id="TaskList_inputBody">
                            {{item.inputBody}}
                        </td>
                        <td id="TaskList_outputBody">
                            {{item.outputBody}}
                        </td>
                        <td id="TaskList_errorBody">
                            {{item.errorBody}}
                        </td>
                        <td id="TaskList_parentDocumentModel">
                            {{item.parentDocumentModel}}
                        </td>
                        <td>
                            <div class="flex">
                                <button id="TaskList_editRecord" pButton pRipple icon="pi pi-pencil"
                                    class="p-button-rounded p-button-success mr-2"
                                    (click)="this.editRecord(item)"></button>
                            </div>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>

        <p-dialog [(visible)]="deleteRecordDialog" header="Confirm" [modal]="true" [style]="{width:'450px'}">
            <div class="flex align-items-center justify-content-center">
                <i id="TaskList_DeleteRecordConfirmationIcon" class="pi pi-exclamation-triangle mr-3"
                    style="font-size: 2rem"></i>
                <span id="TaskList_DeleteRecordConfirmationMSG" *ngIf="this.selectedRecord">Are you sure you want to
                    delete <b>{{selectedRecord.name}}</b>?</span>
            </div>
            <ng-template pTemplate="footer">
                <button id="TaskList_DeleteRecord_No" pButton pRipple icon="pi pi-times" class="p-button-text"
                    label="No" (click)="this.deleteRecordDialog = false"></button>
                <button id="TaskList_DeleteRecord_Yes" pButton pRipple icon="pi pi-check" class="p-button-text"
                    label="Yes" (click)="this.deleteRecord()"></button>
            </ng-template>
        </p-dialog>

        <p-dialog [(visible)]="this.deleteSelectedRecordsDialog" header="Confirm" [modal]="true"
            [style]="{width:'450px'}">
            <div class="flex align-items-center justify-content-center">
                <i id="TaskList_DeleteManyConfirmationMSGIcon" class="pi pi-exclamation-triangle mr-3"
                    style="font-size: 2rem"></i>
                <span id="TaskList_DeleteManyConfirmationMSG">Are you sure you want to delete selected records?</span>
            </div>
            <ng-template pTemplate="footer">
                <button id="TaskList_DeleteManyRecord_No" pButton pRipple icon="pi pi-times" class="p-button-text"
                    label="No" (click)="this.deleteManyRecordsDialog = false"></button>
                <button id="TaskList_DeleteManyRecord_Yes" pButton pRipple icon="pi pi-check" class="p-button-text"
                    label="Yes" (click)="this.deleteSelectedRecords()"></button>
            </ng-template>
        </p-dialog>
    </div>
</div>