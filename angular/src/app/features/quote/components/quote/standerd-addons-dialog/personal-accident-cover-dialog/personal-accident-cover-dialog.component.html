<div class="card modal-body" *ngIf="this.permissions.includes('read')">
    <!--   <div *ngIf="this.config.data.quote?.productId?.type == 'Bharat Griha Raksha Policy'">
        <form class="" [formGroup]="this.coverForm" (ngSubmit)="this.submitForm()" id="PersonalaccidentDialog_Form">
            <div class="grid mb-5">
                <div class="col-6 mb-2" tooltipPosition="bottom">
                    <label for="" class="form-label" id="PersonalaccidentDialog_Name_Label">Name</label>
                    <input maxlength="100" id="PersonalaccidentDialog_Name" pInputText formControlName="name"
                        placeholder="Enter Name" class="p-inputtext1" *ngIf="this.permissions.includes('update')">
                    <input maxlength="100" id="PersonalaccidentDialog_Name" pInputText formControlName="name"
                        placeholder="Enter Name" class="p-inputtext1" *ngIf="!this.permissions.includes('update')"
                        disabled="true">
                    <small id="PersonalaccidentDialog_NameErrorMSG" class="ng-dirty ng-invalid"
                        *ngIf="coverForm.controls['name']?.errors?.required">Name is required.</small>
                    <small id="PersonalaccidentDialog_NameErrorMSG" class="ng-dirty ng-invalid"
                        *ngIf="coverForm.controls['name']?.errors?.pattern">Only Alphabets are allowed.</small>
                </div>
                <div class="col-12 md:col-6 mb-2">
                    <label for="" class="form-label" id="PersonalaccidentDialog_ProposerAge_Label">Proposer Age</label>
                    <input pInputText type="number" id="PersonalaccidentDialog_ProposerAge"
                        formControlName="proposerAge" placeholder="Enter Proposer Age" class="p-inputtext1"
                        *ngIf="this.permissions.includes('update')">
                    <input pInputText type="number" id="PersonalaccidentDialog_ProposerAge"
                        formControlName="proposerAge" placeholder="Enter Proposer Age" class="p-inputtext1"
                        *ngIf="!this.permissions.includes('update')" disabled="true">
                    <small class="ng-dirty ng-invalid" id="PersonalaccidentDialog_ProposerAge_ErrorMSG"
                        *ngIf="coverForm.controls['proposerAge']?.errors?.pattern || coverForm.controls['proposerAge']?.errors?.min">Invalid
                        Age</small>

                </div>
                <div class="col-6 mb-2" tooltipPosition="bottom">
                    <label for="" class="form-label" id="PersonalaccidentDialog_SpouseName_Label">Spouse Name</label>
                    <input maxlength="100" pInputText id="PersonalaccidentDialog_SpouseName"
                        formControlName="spouseName" placeholder="Enter Name" class="p-inputtext1"
                        *ngIf="this.permissions.includes('update')">
                    <input maxlength="100" pInputText id="PersonalaccidentDialog_SpouseName"
                        formControlName="spouseName" placeholder="Enter Name" class="p-inputtext1"
                        *ngIf="!this.permissions.includes('update')" disabled="true">
                    <small class="ng-dirty ng-invalid" id="PersonalaccidentDialog_SpouseName_MSG"
                        *ngIf="coverForm.controls['spouseName']?.errors?.required">SpouseName is required.</small>
                    <small class="ng-dirty ng-invalid" id="PersonalaccidentDialog_SpouseName_MSG"
                        *ngIf="coverForm.controls['spouseName']?.errors?.pattern">Only Alphabets are allowed.</small>
                </div>
                <div class="col-6 mb-2" tooltipPosition="bottom">
                    <label for="" class="form-label" id="PersonalaccidentDialog_SpouseAge_Name">Spouse Age</label>
                    <input pInputText type="number" id="PersonalaccidentDialog_SpouseAge" formControlName="spouseAge"
                        placeholder="Enter Spouse Age" step="0" class="p-inputtext1"
                        *ngIf="this.permissions.includes('update')">
                    <input pInputText type="number" id="PersonalaccidentDialog_SpouseAge" formControlName="spouseAge"
                        placeholder="Enter Spouse Age" step="0" class="p-inputtext1"
                        *ngIf="!this.permissions.includes('update')" disabled="true">
                    <small class="ng-dirty ng-invalid" id="PersonalaccidentDialog_SpouseAge_ErrorMSG"
                        *ngIf="coverForm.controls['spouseAge']?.errors?.pattern || coverForm.controls['spouseAge']?.errors?.min">Invalid
                        Age</small>

                </div>
                <div class="col-8 mt-3 flex">
                    <button class="btn btn-success mr-4" id="PersonalaccidentDialog_Save"
                        [disabled]="this.coverForm.invalid" type="submit"
                        *ngIf="this.permissions.includes('update')">Save</button>
                    <button class="btn btn-outline-light" id="PersonalaccidentDialog_Close" type="button"
                        (click)="cancel()">Close</button>
                </div>
            </div>
        </form>
    </div> -->
    <div>
        <form class="" [formGroup]="personalAccidentForm" (ngSubmit)="this.submitPersonalAccidentForm()"
              #$form="ngForm">
            <div formArrayName="formArray" *ngFor="let form of this.formArray.controls; let i = index">
                <div [formGroupName]="i">

                    <div class="sign-in-head flex align-items-center justify-content-between"
                         *ngIf="this.permissions.includes('update')">
                        <h4 class="head5">Personal Accident {{ i + 1 }}</h4>
                        <a class="red-link" id="LiabilitySection_Form_Delete"
                           (click)="this.deleteFormBasedOnIndex(i)" *ngIf="this.formArray.controls.length > 1">Delete</a>
                    </div>
                    <div class="grid">
                        <div class="col-6 mb-5">
                            <label for="" class="form-label" id="LiabilitySection_Dialog_RiskType_label">Risk
                                Type</label>
                            <div class="pp-dropdown-c">

                                <p-autoComplete class="custom-dropdown" id="LiabilitySection_Dialog_RiskType"
                                                [readonly]="!this.permissions.includes('update')"
                                                [dropdown]="this.permissions.includes('update') ? true : false"
                                                [suggestions]="this.optionsRiskType" field="label" formControlName="riskTypeId"
                                                (completeMethod)="this.searchOptionsRiskType($event,i)"
                                                placeholder="Select Risk Type" [forceSelection]="true"
                                                (onSelect)="createSumInsuredForEmp($event,i)" [showEmptyMessage]="true"
                                                [ngClass]="{'ng-invalid ng-dirty': $form.submitted && form.controls['riskTypeId']?.errors}">
                                </p-autoComplete>

                                <small class="ng-dirty ng-invalid" id="LiabilitySection_Dialog_RiskType_ValidationError"
                                       *ngIf="$form.submitted && form.controls['riskTypeId']?.errors?.required">Risk
                                    Type is required.</small>
                            </div>
                        </div>
                        <div class="col-6 mb-5"
                             *ngIf="form.value['riskTypeId']?.label == 'Spouse' && quote?.productId?.shortName == 'GLL'">
                            <label for="" id="LiabilitySection_Dialog_Description_Label" class="form-label">Name
                            </label>
                            <input pInputText id="LiabilitySection_Dialog_Description" formControlName="name"
                                   [readonly]="!this.permissions.includes('update')" value="" type="text"
                                   class="p-inputtext1"
                                   [ngClass]="{'ng-invalid ng-dirty': $form.submitted && form.controls['name']?.errors}"
                                   placeholder="Name">

                            <small class="ng-dirty ng-invalid" id="LiabilitySection_Dialog_Description_ValidationError"
                                   *ngIf="form.controls['name']?.errors?.required">
                                This field is required.</small>
                            <small class="ng-dirty ng-invalid" *ngIf="form.value['name']?.length > 32">Name
                                cannot be greater than 32 Characters.</small>
                        </div>
                        <div class="col-6 mb-5"
                             *ngIf="quote?.productId?.shortName == 'GLL' && (form.value['riskTypeId']?.label == 'Owner' || form.value['riskTypeId']?.label == 'Spouse')">
                            <label for="" id="LiabilitySection_Dialog_Description_Label" class="form-label">Gender
                            </label>
                            <p-dropdown class="form-control" [options]="this.optionsGender"
                                        placeholder="Select a Relation" optionLabel="label" optionValue="value"
                                        [showClear]="true" formControlName="gender"
                                        [ngClass]="{'ng-invalid ng-dirty': $form.submitted && !form.controls['gender'].valid}"></p-dropdown>
                            <small class="ng-dirty ng-invalid" id="LiabilitySection_Dialog_Description_ValidationError"
                                   *ngIf="form.controls['gender']?.errors?.required">
                                This field is required.</small>
                        </div>
                        <div class="col-6 mb-5"
                             *ngIf="quote?.productId?.shortName == 'GLL' && (form.value['riskTypeId']?.label == 'Owner' || form.value['riskTypeId']?.label == 'Spouse')">
                            <label for="" id="LiabilitySection_Dialog_Description_Label" class="form-label">Occupation
                            </label>
                            <input pInputText id="LiabilitySection_Dialog_Description" formControlName="occupation"
                                   [readonly]="!this.permissions.includes('update')" value="" type="text"
                                   class="p-inputtext1"
                                   [ngClass]="{'ng-invalid ng-dirty': $form.submitted && form.controls['occupation']?.errors}"
                                   placeholder="Occupation">

                            <small class="ng-dirty ng-invalid" id="LiabilitySection_Dialog_Description_ValidationError"
                                   *ngIf="form.controls['occupation']?.errors?.required">
                                This field is required.</small>
                            <small class="ng-dirty ng-invalid" *ngIf="form.value['occupation']?.length > 32">Nominee
                                Name cannot be greater than 32 Characters.</small>
                        </div>
                        <div class="col-6 mb-5" *ngIf="form.value['riskTypeId']?.label != 'Employee'">
                            <label for="" id="LiabilitySection_Dialog_Description_Label" class="form-label">Description
                                Risk</label>
                            <input pInputText id="LiabilitySection_Dialog_Description" formControlName="riskDescription"
                                   [readonly]="!this.permissions.includes('update')" value="" type="text" maxlength="255"
                                   class="p-inputtext1"
                                   [ngClass]="{'ng-invalid ng-dirty': $form.submitted && form.controls['riskDescription']?.errors}"
                                   placeholder="Enter Description">

                            <small class="ng-dirty ng-invalid" id="LiabilitySection_Dialog_Description_ValidationError"
                                   *ngIf="$form.submitted && form.controls['riskDescription']?.errors?.required">
                                Description is required.</small>
                            <small class="ng-dirty ng-invalid"
                                   *ngIf="form.value['riskDescription']?.length > 255">Description
                                cannot be greater than 255 Characters.</small>
                        </div>

                        <!-- Add Employee Name Field -->
                        <!--                        <div class="field col-6 mb-5" *ngIf="form.value['riskTypeId']?.label == 'Employee'">-->
                        <!--                            <label for="" id="LiabilitySection_Dialog_Description_Label" class="form-label">-->
                        <!--                                Number of Employees</label>-->
                        <!--                            <p-inputNumber [style]="{'display': 'unset !important'}"-->
                        <!--                                id="LiabilitySection_Dialog_Description" formControlName="noOfEmployee"-->
                        <!--                                [showButtons]="true" min="0"-->
                        <!--                                [ngClass]="{'ng-invalid ng-dirty': $form.submitted && form.controls['noOfEmployee']?.errors}"-->
                        <!--                                [readonly]="!this.permissions.includes('update')"></p-inputNumber>-->
                        <!--                            <small class="ng-dirty ng-invalid"-->
                        <!--                                *ngIf="form.controls['noOfEmployee']?.errors?.required">This-->
                        <!--                                field is required.</small>-->

                        <!--                            <small class="ng-dirty ng-invalid" id="LiabilitySection_Dialog_SumInsured_ValidationError2"-->
                        <!--                                *ngIf="form.controls['noOfEmployee']?.errors?.min">No of Employees should-->
                        <!--                                be greater than {{form.controls['riskTypeId']?.value.empMin}}.</small>-->
                        <!--                            <small class="ng-dirty ng-invalid" *ngIf="form.controls['noOfEmployee']?.errors?.max">No of-->
                        <!--                                Employees should be less {{form.controls['riskTypeId']?.value?.empMax}}.</small>-->
                        <!--                        </div>-->
                        <div class="col-6 mb-5" *ngIf="form.value['riskTypeId']?.label != 'Employee'">
                            <label for="" id="PLiabilitySection_Dialog_SumInsured_label"
                                   class="form-label">Sum Insured</label>

                            <p-inputNumber
                                *ngIf="form.value['riskTypeId']?.label != 'Employee' && form.value['riskTypeId']?.label != 'Owner' && form.value['riskTypeId']?.label != 'Spouse'"
                                id="LiabilitySection_Dialog_SumInsured" mode="decimal" locale="en-IN" prefix="â‚¹ "
                                [minFractionDigits]="0" placeholder="0" formControlName="sumInsured"
                                [readonly]="!this.permissions.includes('update')" maxlength="21"
                                [ngClass]="{'ng-invalid ng-dirty': $form.submitted && !form.value['sumInsured']}">
                            </p-inputNumber>
                            <p-autoComplete
                                *ngIf=" form.value['riskTypeId']?.label == 'Owner' || form.value['riskTypeId']?.label == 'Spouse'"
                                class="custom-dropdown" id="LiabilitySection_Dialog_RiskType"
                                [readonly]="!this.permissions.includes('update')"
                                [dropdown]="this.permissions.includes('update') ? true : false"
                                [suggestions]="this.optionDropDownForEmpSum" field="label" formControlName="sumInsured"
                                placeholder="Select" [forceSelection]="true" [showEmptyMessage]="true"
                                (completeMethod)="this.searchOptionsRiskType($event,i)"
                                [ngClass]="{'ng-invalid ng-dirty': $form.submitted && form.controls['sumInsured']?.errors}">
                            </p-autoComplete>

                            <small class="ng-dirty ng-invalid" id="PersonalAccident_Dialog_SumInsured_ValidationError"
                                   *ngIf="$form.submitted && form.controls['sumInsured']?.errors?.required">Sum Insured
                                cannot be blank.</small>

                            <small class="ng-dirty ng-invalid" id="LiabilitySection_Dialog_SumInsured_ValidationError2"
                                   *ngIf="$form.submitted && form.controls['sumInsured']?.errors?.min">SumInsured should be
                                greater than 1.</small>
                        </div>
                        <div class="field col-6 mb-5"
                             *ngIf="form.value['riskTypeId']?.label == 'Owner' || form.value['riskTypeId']?.label == 'Spouse'">
                            <label for="" id="LiabilitySection_Dialog_Description_Label" class="form-label"
                                   *ngIf="form.value['riskTypeId']?.label == 'Owner'">
                                Insured Age</label>
                            <label for="" id="LiabilitySection_Dialog_Description_Label" class="form-label"
                                   *ngIf="form.value['riskTypeId']?.label == 'Spouse'">
                                Spouse Age</label>
                            <!-- <p-inputNumber [style]="{'display': 'unset !important'}"
                                           id="LiabilitySection_Dialog_Description" formControlName="insuredAge"
                                           [showButtons]="true" min="1"
                                           [ngClass]="{'ng-invalid ng-dirty': $form.submitted && form.controls['insuredAge']?.errors}"
                                           [readonly]="!this.permissions.includes('update')"></p-inputNumber> -->
                            <p-inputNumber [style]="{'display': 'unset !important'}"
                                id="LiabilitySection_Dialog_Description" formControlName="insuredAge"
                                maxlength="2"
                                [ngClass]="{'ng-invalid ng-dirty': $form.submitted && form.controls['insuredAge']?.errors}"
                                [readonly]="!this.permissions.includes('update')"></p-inputNumber>
                            <small class="ng-dirty ng-invalid"
                                   *ngIf="form.controls['insuredAge']?.errors?.required">This
                                field is required.</small>
                            <small class="ng-dirty ng-invalid"
                                   id="WorkmenCompensation_Dialog_SumInsured_ValidationError2"
                                   *ngIf="form.controls['insuredAge']?.errors?.max">Invalid Age.</small>
                        </div>
                        <div class="col-6 mb-5"
                             *ngIf="form.value['riskTypeId']?.label == 'Owner' || form.value['riskTypeId']?.label == 'Spouse'">
                            <label for="" id="LiabilitySection_Dialog_Description_Label" class="form-label">Nominee Name
                            </label>
                            <input pInputText id="LiabilitySection_Dialog_Description" formControlName="nomineeName"
                                   [readonly]="!this.permissions.includes('update')" value="" type="text"
                                   class="p-inputtext1"
                                   [ngClass]="{'ng-invalid ng-dirty': $form.submitted && form.controls['nomineeName']?.errors}"
                                   placeholder="Name of Nominee">

                            <small class="ng-dirty ng-invalid" id="LiabilitySection_Dialog_Description_ValidationError"
                                   *ngIf="form.controls['nomineeName']?.errors?.required">
                                This field is required.</small>
                            <small class="ng-dirty ng-invalid" *ngIf="form.value['nomineeName']?.length > 32">Nominee
                                Name cannot be greater than 32 Characters.</small>
                        </div>
                        <div class="col-6 mb-5"
                             *ngIf="form.value['riskTypeId']?.label == 'Owner' || form.value['riskTypeId']?.label == 'Spouse'">
                            <label for="" id="LiabilitySection_Dialog_Description_Label" class="form-label">Nominee
                                Relation
                            </label>
                            <p-dropdown class="form-control" [options]="this.optionsRelation"
                                        placeholder="Select a Relation" optionLabel="label" optionValue="value"
                                        [showClear]="true" formControlName="nomineeRelation"
                                        [ngClass]="{'ng-invalid ng-dirty': submitted && !form.controls['nomineeRelation'].valid}"></p-dropdown>
                            <small class="ng-dirty ng-invalid" id="LiabilitySection_Dialog_Description_ValidationError"
                                   *ngIf="form.controls['nomineeRelation']?.errors?.required">
                                This field is required.</small>
                        </div>
                        <div class="col-6 mb-5 mt-3" *ngIf="form.value['riskTypeId']?.label === 'Employee'">
                            <a (click)="downloadExcel()" class="btn btn-blue-ff me-4" type="submit"><i class="downloadfile"></i> Download Sample
                                File</a>
                        </div>
                        <div class="col-6 mb-5"
                             *ngIf="form.value['riskTypeId']?.label === 'Employee' && (!form.value['fileInput'] || (form.value['fileInput'] && isFile(form.value['fileInput'])))">
                            <label for="" id="PersonalAccident_Dialog_SumInsured_label" class="form-label">File</label>
                            <input style="display: none;" type="text" formControlName="fileInput">
                            <p-fileUpload mode="advanced" name="demo[]" maxFileSize="10000000"
                                          styleClass="upload-outline-light" chooseIcon="pi pi-paperclip"
                                          chooseLabel="Upload Document" (onSelect)="onBasicUpload($event,i)"></p-fileUpload>
                            <small style="font-style: italic;">**Allowed File Types XLX/XLSX.</small>
                        </div>

                        <div class="col-4 max-h-full min-h-full flex align-items-center"
                             *ngIf="form.value['fileInput'] && !isFile(form.value['fileInput'])">
                            <a (click)="downloadFile(i)" class="mr-2">
                                <i class="pi pi-download mr-1" style="font-size: 1rem"></i>Download File
                            </a>
                        </div>
                    </div>
                </div>

            </div>
            <div class="col-12 mb-1 md:mb-5 text-right" *ngIf="this.permissions.includes('update')">
                <a class="add-more" id="Add_LiabilitySection_Form" (click)="this.addFormToArray()">+ Add More</a>
            </div>
            <div class="col-12 mt-3">
                <div class="flex justify-content-end">
                    <button id="LiabilitySection_dialog_Save" class="btn btn-success mr-4" type="submit"
                            *ngIf="this.permissions.includes('update')">Save</button>
                    <button id="LiabilitySection_dialog_Close" class="btn btn-outline-light mt-1" type="button"
                            (click)="cancel()">Close</button>
                </div>
            </div>
        </form>
    </div>
</div>
