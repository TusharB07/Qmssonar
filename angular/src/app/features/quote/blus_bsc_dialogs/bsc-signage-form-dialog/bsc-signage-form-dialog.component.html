<div class="card modal-body" *ngIf="this.permissions.includes('read')">
    <form class="" [formGroup]="signageForm" (ngSubmit)="this.submitSignageForm()" #$form="ngForm">

        <div formArrayName="formArray" *ngFor="let form of this.formArray.controls; let i = index">
            <div [formGroupName]="i">

                <div class="sign-in-head flex align-items-center justify-content-between"
                    *ngIf="this.permissions.includes('update')">
                    <h4 class="head5">BSC Signage {{ i + 1 }}</h4>
                    <a class="red-link" id="Signage_Form_Delete" (click)="this.deleteFormBasedOnIndex(i)" *ngIf="this.formArray.controls.length > 1">Delete</a>
                </div>

                <div class="grid md:mb-5">
                    <div class="col-12 md:col-6 mb-1 md:mb-5">
                        <label for="" class="form-label" id="Signage_Dialog_signageType_label">Signage Type</label>
                        <div class="pp-dropdown-c">
                            <p-autoComplete class="custom-dropdown" id="Signage_Dialog_signageType"
                            [readonly]="!this.permissions.includes('update')" [dropdown]="this.permissions.includes('update') ? true : false"
                                [suggestions]="this.optionsSignageType" field="label" formControlName="signageTypeId"
                                (completeMethod)="this.searchOptionsSignageType($event)"
                                placeholder="Select Signage Type"
                                [showEmptyMessage]="true"
                                [forceSelection]="true"
                                [ngClass]="{'ng-invalid ng-dirty': $form.submitted && form.controls['signageTypeId']?.errors}">
                            </p-autoComplete>

                            <small class="ng-dirty ng-invalid" id="Signage_Dialog_signageType_ValidationError"
                                *ngIf="$form.submitted && form.controls['signageTypeId']?.errors?.required">Signage Type
                                is required.</small>
                        </div>
                    </div>
                    <div class="col-12 md:col-6 mb-1 md:mb-5">
                        <label for="" id="Signage_Dialog_Descrition_label" class="form-label">Description of
                            Signage</label>
                        <input pInputText id="Signage_Dialog_Descrition" formControlName="signageDescription"
                        [readonly]="!this.permissions.includes('update')" value="" type="text" class="p-inputtext1"
                            placeholder="Enter Description"
                            [ngClass]="{'ng-invalid ng-dirty': $form.submitted && form.controls['signageDescription']?.errors}">

                        <small class="ng-dirty ng-invalid" id="Signage_Dialog_Descrition_ValidationError"
                            *ngIf="$form.submitted && form.controls['signageDescription']?.errors?.required">Signage
                            Description is required.</small>
                        <small class="ng-dirty ng-invalid"
                            *ngIf="form.value['signageDescription']?.length > 255">Description
                            cannot be greater
                            than 255 Characters.</small>
                    </div>
                    <div class="col-12 md:col-6 mb-1 md:mb-5">
                        <label for="" id="Signage_Dialog_SumInsured_label" class="form-label">Sum Insured</label>
                        <!-- <input maxlength="11" pInputText id="Signage_Dialog_SumInsured" formControlName="sumInsured"
                            value="" *ngIf="this.permissions.includes('update')" currencyMask
                            [options]="{ prefix: '₹ ' , precision:0 }" class="p-inputtext1">
                        <input maxlength="11" pInputText id="Signage_Dialog_SumInsured" formControlName="sumInsured"
                            value="" *ngIf="!this.permissions.includes('update')" readonly="true" currencyMask
                            [options]="{ prefix: '₹ ' , precision:0 }" class="p-inputtext1"> -->
                         <!-- TO GET THE COUNT OF VALUES IN RUPEES INSTEAD OF MILLIONS -->
                         <p-inputNumber id="Signage_Dialog_SumInsured"
                         mode="decimal" locale="en-IN" prefix="₹ "
                         [minFractionDigits]="0" placeholder="0"
                         formControlName="sumInsured"
                         maxlength="21"
                         [readonly]="!this.permissions.includes('update')"
                         [ngClass]="{'ng-invalid ng-dirty':$form.submitted &&  form.controls['sumInsured']?.errors}"
                         >
                     </p-inputNumber>
                        <small style="color :brown;font-style: italic;" id="Signage_Dialog_SumInsured_ValidationError"
                            *ngIf="form.controls['signageTypeId']?.value">Range for SI is {{form.controls['signageTypeId']?.value?.sumMin}} - {{form.controls['signageTypeId']?.value?.sumMax}}</small><br>
                            <small style="color :brown;font-style: italic;" *ngIf="form.controls['signageTypeId']?.value">NSTP Range for SI is {{minNSTP}} - {{form.controls['signageTypeId']?.value?.maxNSTP}}</small>
                        <!-- <small class="ng-dirty ng-invalid" id="Signage_Dialog_SumInsured_ValidationError"
                            *ngIf="$form.submitted && form.controls['sumInsured']?.errors?.required">Sum Insured is
                            required.</small>
                        <small class="ng-dirty ng-invalid" id="Signage_Dialog_SumInsured_ValidationError"
                            *ngIf="$form.submitted && form.controls['sumInsured']?.errors?.min">Sum Insured should be greater than 1.</small> -->

                    </div>
                    <div class="md:col-6"></div>
                    <div class="col-12 md:col-6 mb-1 md:mb-5"
                        *ngIf="!form.value['fileInput'] || (form.value['fileInput'] && isFile(form.value['fileInput']))">
                        <label for="" id="PortableEquipments_Dialog_SumInsured_label" class="form-label">File</label>
                        <input style="display: none;" type="text" formControlName="fileInput">
                        <p-fileUpload mode="advanced" name="demo[]" maxFileSize="10000000" styleClass="upload-outline-light"
                            chooseIcon="pi pi-paperclip" chooseLabel="Upload Document" accept=""
                            (onSelect)="onBasicUpload($event,i)"></p-fileUpload>
                        <small style="font-style: italic;">**Allowed File Types XLX/XLSX.</small>
                    </div>
                    <div class="col-12 md:col-4 mb-1 max-h-full min-h-full flex align-items-center" *ngIf="form.value['fileInput'] && !isFile(form.value['fileInput'])">
                        <a [href]="form.value['fileInput']" (click)="downloadFile(i)" class="mr-2">
                            <i class="pi pi-download mr-1" style="font-size: 1rem"></i>Download File
                        </a>
                        <i *ngIf="form.value['fileInput'] && this.permissions.includes('update')"  class="pi pi-trash" style="font-size: 1.5rem" (click)="deletefile(i)"></i>   
                    </div>
                    <!-- <div class="col-4 text-center">
                <div class="total-premium">
                    <div class="premium">Total Premium</div>
                    <div class="price">{{totalPremium | currency:"INR"}}</div>
                  </div>
            </div> -->
                </div>
            </div>
        </div>


        <div class="">
            <div class="mb-1 md:mb-5 text-right" *ngIf="this.permissions.includes('update')">
                <a class="blue-link" id="Add_Signage_Form" (click)="this.addFormToArray()">+ Add more</a>
            </div>
        </div>
        <div class="mt-3 flex justify-content-end">
            <button id="Signage_dialog_Save" class="btn btn-success mr-4" type="submit"
                *ngIf="this.permissions.includes('update')">Save</button>
            <button id="Signage_dialog_Close" class="btn btn-outline-light" type="button"
                (click)="cancel()">Close</button>
        </div>
    </form>
</div>
